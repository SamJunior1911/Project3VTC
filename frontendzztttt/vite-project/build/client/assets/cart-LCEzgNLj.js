import{a as o,p as t,w as K}from"./chunk-NISHYRIK-G1YWtZ6E.js";import{a as M}from"./index-ngrFHoWO.js";import{M as U,i as q,u as S,P as B,a as G,b as V,L as D,m as v,t as _}from"./proxy-DEVxXJM5.js";import"./index-29VLREAS.js";function $(e,s){if(typeof e=="function")return e(s);e!=null&&(e.current=s)}function Z(...e){return s=>{let n=!1;const a=e.map(c=>{const r=$(c,s);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let c=0;c<a.length;c++){const r=a[c];typeof r=="function"?r():$(e[c],null)}}}}function F(...e){return o.useCallback(Z(...e),e)}class O extends o.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const a=n.offsetParent,c=q(a)&&a.offsetWidth||0,r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft,r.right=c-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function X({children:e,isPresent:s,anchorX:n,root:a}){const c=o.useId(),r=o.useRef(null),i=o.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=o.useContext(U),m=F(r,e?.ref);return o.useInsertionEffect(()=>{const{width:d,height:f,top:h,left:x,right:g}=i.current;if(s||!r.current||!d||!f)return;const w=n==="left"?`left: ${x}`:`right: ${g}`;r.current.dataset.motionPopId=c;const p=document.createElement("style");l&&(p.nonce=l);const b=a??document.head;return b.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${c}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${f}px !important;
            ${w}px !important;
            top: ${h}px !important;
          }
        `),()=>{b.contains(p)&&b.removeChild(p)}},[s]),t.jsx(O,{isPresent:s,childRef:r,sizeRef:i,children:o.cloneElement(e,{ref:m})})}const J=({children:e,initial:s,isPresent:n,onExitComplete:a,custom:c,presenceAffectsLayout:r,mode:i,anchorX:l,root:m})=>{const d=S(Q),f=o.useId();let h=!0,x=o.useMemo(()=>(h=!1,{id:f,initial:s,isPresent:n,custom:c,onExitComplete:g=>{d.set(g,!0);for(const w of d.values())if(!w)return;a&&a()},register:g=>(d.set(g,!1),()=>d.delete(g))}),[n,d,a]);return r&&h&&(x={...x}),o.useMemo(()=>{d.forEach((g,w)=>d.set(w,!1))},[n]),o.useEffect(()=>{!n&&!d.size&&a&&a()},[n]),i==="popLayout"&&(e=t.jsx(X,{isPresent:n,anchorX:l,root:m,children:e})),t.jsx(B.Provider,{value:x,children:e})};function Q(){return new Map}const N=e=>e.key||"";function T(e){const s=[];return o.Children.forEach(e,n=>{o.isValidElement(n)&&s.push(n)}),s}const Y=({children:e,custom:s,initial:n=!0,onExitComplete:a,presenceAffectsLayout:c=!0,mode:r="sync",propagate:i=!1,anchorX:l="left",root:m})=>{const[d,f]=G(i),h=o.useMemo(()=>T(e),[e]),x=i&&!d?[]:h.map(N),g=o.useRef(!0),w=o.useRef(h),p=S(()=>new Map),[b,I]=o.useState(h),[j,P]=o.useState(h);V(()=>{g.current=!1,w.current=h;for(let y=0;y<j.length;y++){const u=N(j[y]);x.includes(u)?p.delete(u):p.get(u)!==!0&&p.set(u,!1)}},[j,x.length,x.join("-")]);const R=[];if(h!==b){let y=[...h];for(let u=0;u<j.length;u++){const C=j[u],E=N(C);x.includes(E)||(y.splice(u,0,C),R.push(C))}return r==="wait"&&R.length&&(y=R),P(T(y)),I(h),null}const{forceRender:H}=o.useContext(D);return t.jsx(t.Fragment,{children:j.map(y=>{const u=N(y),C=i&&!d?!1:h===j||x.includes(u),E=()=>{if(p.has(u))p.set(u,!0);else return;let L=!0;p.forEach(W=>{W||(L=!1)}),L&&(H?.(),P(w.current),i&&f?.(),a&&a())};return t.jsx(J,{isPresent:C,initial:!g.current||n?void 0:!1,custom:s,presenceAffectsLayout:c,mode:r,root:m,onExitComplete:C?void 0:E,anchorX:l,children:y},u)})})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),te=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,n,a)=>a?a.toUpperCase():n.toLowerCase()),z=e=>{const s=te(e);return s.charAt(0).toUpperCase()+s.slice(1)},A=(...e)=>e.filter((s,n,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===n).join(" ").trim(),se=e=>{for(const s in e)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ne={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=o.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:c="",children:r,iconNode:i,...l},m)=>o.createElement("svg",{ref:m,...ne,width:s,height:s,stroke:e,strokeWidth:a?Number(n)*24/Number(s):n,className:A("lucide",c),...!r&&!se(l)&&{"aria-hidden":"true"},...l},[...i.map(([d,f])=>o.createElement(d,f)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=(e,s)=>{const n=o.forwardRef(({className:a,...c},r)=>o.createElement(re,{ref:r,iconNode:s,className:A(`lucide-${ee(z(e))}`,`lucide-${e}`,a),...c}));return n.displayName=z(e),n};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ae=k("arrow-left",oe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],ce=k("credit-card",ie);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],de=k("shopping-cart",le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ue=k("trash-2",he);M.defaults.withCredentials=!0;const pe=()=>{const[e,s]=o.useState([]),[n,a]=o.useState(!0),c=e.reduce((i,l)=>i+l.price*l.quantity,0);o.useEffect(()=>{(async()=>{try{const m=(await M.get("http://localhost:3002/api/cart")).data.cart||[],d=await Promise.all(m.map(async f=>{try{const h=await M.get(`http://localhost:3001/api/assets/${f.product_id}`);return{...f,image:h.data?.[0]?.path||"https://res.cloudinary.com/demo/image/upload/v1699999999/default_product.png"}}catch{return{...f,image:"https://res.cloudinary.com/demo/image/upload/v1699999999/default_product.png"}}}));s(d)}catch{_.error("Kh√¥ng th·ªÉ t·∫£i gi·ªè h√†ng!")}finally{a(!1)}})()},[]);const r=i=>{s(l=>l.filter(m=>m.product_id!==i)),_.success("ƒê√£ x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng!")};return n?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-orange-400 border-t-transparent"})}):t.jsxs("section",{className:"max-w-7xl mx-auto px-6 py-10 bg-gradient-to-b from-orange-50 to-white min-h-screen",children:[t.jsxs("div",{className:"flex items-center justify-between mb-10",children:[t.jsxs("h2",{className:"text-3xl font-bold text-orange-600 flex items-center gap-2",children:[t.jsx(de,{className:"w-8 h-8 text-orange-500"}),"Gi·ªè h√†ng c·ªßa b·∫°n"]}),t.jsxs("button",{onClick:()=>window.location.href="/",className:"flex items-center gap-2 text-orange-600 hover:text-orange-700 font-medium transition-all",children:[t.jsx(ae,{size:20})," Ti·∫øp t·ª•c mua s·∫Øm"]})]}),e.length===0?t.jsxs("div",{className:"text-center py-20 bg-white rounded-3xl shadow-xl border border-orange-100",children:[t.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/11329/11329060.png",alt:"Empty Cart",className:"mx-auto w-44 mb-4 opacity-90"}),t.jsx("p",{className:"text-gray-600 text-lg mb-5",children:"Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng"}),t.jsx("button",{className:"bg-gradient-to-r from-orange-500 to-orange-600 hover:scale-105 text-white px-10 py-3 rounded-xl font-semibold shadow-lg transition-all",onClick:()=>window.location.href="/home",children:"üõçÔ∏è Mua s·∫Øm ngay"})]}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10",children:[t.jsx("div",{className:"lg:col-span-2 space-y-6",children:t.jsx(Y,{children:e.map((i,l)=>t.jsxs(v.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{delay:l*.04,duration:.3},className:"flex items-center justify-between gap-6 bg-white rounded-2xl shadow-md border border-gray-100 p-5 hover:shadow-xl transition-all duration-300",children:[t.jsxs("div",{className:"flex items-center gap-5",children:[t.jsx(v.img,{whileHover:{scale:1.05},src:i.image,alt:i.title,className:"w-28 h-28 object-cover rounded-xl shadow-sm border border-gray-100"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-800 text-lg line-clamp-1",children:i.title}),t.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["S·ªë l∆∞·ª£ng:"," ",t.jsx("span",{className:"font-medium text-gray-700",children:i.quantity})]}),t.jsxs("p",{className:"text-orange-500 font-semibold mt-2",children:[i.price.toLocaleString(),"ƒë"]})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[t.jsxs("p",{className:"text-lg font-bold text-orange-600",children:[(i.price*i.quantity).toLocaleString(),"ƒë"]}),t.jsx(v.button,{whileTap:{scale:.9},className:"text-gray-400 hover:text-red-500 transition-all",onClick:()=>r(i.product_id),children:t.jsx(ue,{size:20})})]})]},i.product_id))})}),t.jsxs(v.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},transition:{duration:.4},className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-orange-100 p-8 h-fit sticky top-10",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800 flex items-center gap-2",children:"üßæ T·ªïng k·∫øt ƒë∆°n h√†ng"}),t.jsxs("div",{className:"space-y-3 text-gray-700",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"T·ªïng s·∫£n ph·∫©m:"}),t.jsx("span",{children:e.length})]}),t.jsxs("div",{className:"border-t pt-3 flex justify-between text-lg font-bold text-orange-600",children:[t.jsx("span",{children:"T·ªïng c·ªông:"}),t.jsxs("span",{children:[c.toLocaleString(),"ƒë"]})]})]}),t.jsxs(v.button,{whileHover:{scale:1.03},whileTap:{scale:.95},className:"mt-8 w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white py-3 rounded-xl font-semibold shadow-lg flex items-center justify-center gap-2",onClick:()=>window.location.href="/checkout",children:[t.jsx(ce,{size:20})," Thanh to√°n ngay"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-4 text-center",children:"*T·ªïng ti·ªÅn ƒë√£ bao g·ªìm thu·∫ø (n·∫øu c√≥)"})]})]})]})},ye=K(pe);export{ye as default};
