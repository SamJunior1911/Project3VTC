import{a as o,p as t,w as V}from"./chunk-NISHYRIK-G1YWtZ6E.js";import{a as b}from"./index-ngrFHoWO.js";function T(){const[d,f]=o.useState({category_id:"",title:"",author:"",description:"",price:"",discount:"",quantity:"",status:"active",is_feature:!1}),[h,y]=o.useState(!1),[m,j]=o.useState(null),[C,N]=o.useState([]),[r,i]=o.useState([]),[g,w]=o.useState([]);o.useEffect(()=>{b.get("http://localhost:3001/api/categories").then(e=>w(e.data.data)).catch(e=>console.log(e))},[]),o.useEffect(()=>{b.get("http://localhost:3001/api/attributes").then(e=>N(e.data.data||e.data)).catch(e=>console.error("Lá»—i khi táº£i attributes:",e))},[]);const c=e=>{f({...d,[e.target.name]:e.target.value})},v=e=>{e.target.files&&j(e.target.files)},S=()=>{i([...r,{attribute_id:"",type:"radio",values:[],selectedValues:[]}])},x=(e,s,a)=>{const l=[...r];l[e][s]=a,i(l)},_=(e,s)=>{const a=[...r];a[e].values=s.split(",").map(l=>l.trim()).filter(l=>l!==""),a[e].selectedValues=[],i(a)},k=async e=>{e.preventDefault();try{const s=new FormData;if(Object.entries(d).forEach(([n,u])=>{s.append(n,u)}),m)for(let n=0;n<m.length;n++)s.append("files",m[n]);const a=r.map(n=>({attribute_id:n.attribute_id,type:n.type,values:Array.isArray(n.selectedValues)&&n.selectedValues.length>0?n.selectedValues:n.values}));console.log("ðŸ“¦ Gá»­i attributes:",a),s.append("attributes",JSON.stringify(a));const l=await b.post("http://localhost:3001/api/products",s,{headers:{"Content-Type":"multipart/form-data"}});alert("âœ… Táº¡o sáº£n pháº©m thÃ nh cÃ´ng!"),console.log("Product created:",l.data)}catch(s){console.error(s),alert(s.response?.data?.message||"Lá»—i khi táº¡o sáº£n pháº©m")}};return t.jsxs("form",{onSubmit:k,className:"p-4 max-w-2xl mx-auto space-y-4",children:[t.jsx("h2",{className:"text-xl font-bold mb-3",children:"Táº¡o sáº£n pháº©m má»›i"}),t.jsxs("select",{name:"category_id",value:d.category_id,onChange:c,className:"border p-2 w-full",children:[t.jsx("option",{value:"",children:"-- Chá»n danh má»¥c --"}),Array.isArray(g)&&g.map(e=>t.jsx("option",{value:e._id,children:e.name},e._id))]}),t.jsx("input",{name:"title",placeholder:"TÃªn sáº£n pháº©m",onChange:c,className:"border p-2 w-full"}),t.jsx("input",{name:"author",placeholder:"TÃ¡c giáº£ / thÆ°Æ¡ng hiá»‡u",onChange:c,className:"border p-2 w-full"}),t.jsx("input",{name:"price",placeholder:"GiÃ¡",onChange:c,type:"number",className:"border p-2 w-full"}),t.jsx("input",{min:"0",name:"discount",placeholder:"Giáº£m giÃ¡ (%)",onChange:c,type:"number",className:"border p-2 w-full"}),t.jsx("input",{name:"quantity",placeholder:"Sá»‘ lÆ°á»£ng",onChange:c,type:"number",className:"border p-2 w-full"}),t.jsx("textarea",{name:"description",placeholder:"MÃ´ táº£ sáº£n pháº©m",onChange:c,className:"border p-2 w-full"}),t.jsx("input",{type:"file",multiple:!0,onChange:v,className:"border p-2 w-full"}),t.jsx("div",{className:"text-center",children:t.jsx("button",{type:"button",onClick:()=>y(!h),children:h?"ðŸ”½ áº¨n thuá»™c tÃ­nh":"ðŸ”¼ Hiá»‡n thuá»™c tÃ­nh"})}),h&&t.jsxs("div",{className:" space-y-3",children:[t.jsx("h3",{className:"font-semibold",children:"Thuá»™c tÃ­nh sáº£n pháº©m"}),r.map((e,s)=>t.jsxs("div",{className:"space-y-2 border-b pb-2",children:[t.jsxs("select",{value:e.attribute_id,onChange:a=>x(s,"attribute_id",a.target.value),className:"border p-2 w-full",children:[t.jsx("option",{value:"",children:"-- Chá»n thuá»™c tÃ­nh --"}),C.map(a=>t.jsx("option",{value:a._id,children:a.name},a._id))]}),t.jsxs("select",{value:e.type,onChange:a=>x(s,"type",a.target.value),className:"border p-2 w-full",children:[t.jsx("option",{value:"radio",children:"Radio"}),t.jsx("option",{value:"checkbox",children:"Checkbox"})]}),t.jsx("input",{placeholder:"Nháº­p giÃ¡ trá»‹ (phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y)",onChange:a=>_(s,a.target.value),className:"border p-2 w-full"}),e.type==="radio"&&e.values.map((a,l)=>t.jsxs("label",{className:"mr-3",children:[t.jsx("input",{type:"radio",name:`radio-${s}`,checked:e.selectedValues?.[0]===a,onChange:()=>{const n=[...r];n[s].selectedValues=[a],i(n)}})," ",a]},l)),e.type==="checkbox"&&e.values.map((a,l)=>t.jsxs("label",{className:"mr-3",children:[t.jsx("input",{type:"checkbox",checked:e.selectedValues?.includes(a)||!1,onChange:n=>{const u=[...r];let p=u[s].selectedValues||[];n.target.checked?p.push(a):p=p.filter(A=>A!==a),u[s].selectedValues=p,i(u)}})," ",a]},l))]},s)),t.jsx("button",{type:"button",onClick:S,className:"bg-blue-500 text-white px-3 py-1 rounded",children:"+ ThÃªm thuá»™c tÃ­nh"})]}),t.jsx("button",{type:"submit",className:"bg-orange-500 text-white px-4 py-2 rounded",children:"Táº¡o sáº£n pháº©m"})]})}function P({}){return[{title:"New React Router App"},{name:"description",content:"Welcome to React Router!"}]}const D=V(function(){return t.jsx(T,{})});export{D as default,P as meta};
